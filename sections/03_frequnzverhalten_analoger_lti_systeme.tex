\section{Frequnzverhalten analoger LTI-Systeme}

\begin{minipage}[c]{0.5\columnwidth}
    \includegraphics[width=\columnwidth]{images/llf_netzwerk.png}
\end{minipage}
\hfill
\begin{minipage}[c]{0.48\columnwidth}
    \raggedright% needed to suppress underfull hbox warning
    Die Betrachtungen beschränken sich auf \textbf{zeitinvariante} LLF-Netzwerke (lineare Netzwerke mit konzentrierten Elementen)
\end{minipage}




\subsection{Zusammenhang Frequenzgang -- UTF}

Alle LTI-Systeme lassen sich mit einer Differntialfleichung der folgenden Form beschreiben:
$$ a_n \frac{\diff^n y}{\diff t^n} + a_{n-1} \frac{\diff^{n-1} y}{\diff t^{n-1}} + \cdots + a_1 \frac{\diff y}{\diff t} + a_0 y =
    b_m \frac{\diff^m x}{\diff t^m} + b_{m-1} \frac{\diff^{m-1} x}{\diff t^{m-1}} + \cdots + b_1 \frac{\diff x}{\diff t} + b_0 x  $$

Die Laplace-Transformierte der DGL hat die Form 
$$ \boxed{ H(s) = \frac{Y(s)}{X(s)} = \frac{b_m s^m + b_{m-1} s^{m-1} + \cdots + b_1 s + b_0}
{a_n s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0}  = \frac{N(s)}{D(s)} }$$

\begin{ctabular}{Ol}
    N(s) & Zählerpolynom mit konstanten, reelen Koeffizienten \\
    D(s) & Nennerpolynom mit konstanten, reelen Koeffizienten \\
    x(t) & Eingangssignal \\
    y(t) & Ausgangssignal \\
\end{ctabular}

\vspace{0.2cm}

Die Wurzeln der Gleichung $N(s) = 0$ ergeben $m$ endliche Nullstellen; die Wurzeln von $D(s) = 0$ ergeben $n$ Pole des Systems.
\textbf{Aus Stabilitätsgründen müssen alle Pole in der linken Halbebene (LHE) liegen!}


\subsubsection{Praktische Schreibweise für Pol-/Nullstellen}

Um die Pole bzw. Nullstellen des Systems direkt ablesen zu können, wird $H(s)$ faktorisiert. \textrightarrow\ Die UTF $H(s)$ ist durch
die Pole, Nullstellen und den Faktor K \textbf{vollständig bestimmt}!

$$ H(s) = \underbrace{\frac{b_m}{a_m}}_{K} \cdot \frac{\prod\limits_{i=1}^m (s - z_i)}{\prod\limits_{j=1}^n (s - p_j)} $$


Da die Wurzeln von Polynomen mit reellen Koeffizienten entweder reell oder konjugiert-komplexe Paare auftreten, ist es meistens
sinnvoll, die Systemfunktionen als Produkt von Faktoren 1. und 2. Ordnung mit reelen Koeffizienten darzustellen.

$$ H(s) = \underbrace{\frac{b_m}{a_m}}_{K} \cdot 
    \frac{\prod\limits_{i=1}^r (\cbl{s^2 + 2 \sigma_{zi} s + \omega_{zi}^2}) \prod\limits_{i=2r+1}^m (\cgn{s - z_i})}
    {\prod\limits_{j=1}^t (\cor{s^2 + 2 \sigma_{pj} s + \omega_{pj}^2}) \prod\limits_{j=2t+1}^n (\cvt{s - p_j})} $$

\textbf{Legende:}
\begin{itemize}
    \item \cbl{Beschreibt komplex-konjugierte Nullstellen in der LHE} 
    \item \cgn{Beschreibt reelle Nullstellen in der LHE}
    \item \cor{Beschreibt komplex-konjugierte Polein der LHE} 
    \item \cvt{Beschreibt reelle Pole in der LHE} 
\end{itemize}

\vspace{0.2cm}

Alternativ kann $H(s)$ mittels \textbf{Polfrequenzen} und \textbf{Polgüten} beschrieben werden:
$$ H(s) = \underbrace{\frac{b_m}{a_m}}_{K} \cdot 
    \frac{\prod\limits_{i=1}^r (s^2 + \frac{\omega_{zi}}{q_{zi}} s + \omega_{zi}^2) \prod\limits_{i=2r+1}^m (s - z_i)}
    {\prod\limits_{j=1}^t (s^2 +\frac{\omega_{pj}}{q_{pj}} s + \omega_{pj}^2) \prod\limits_{j=2t+1}^n (s - p_j)} $$

\begin{ctabular}{Ol Ol}
    \omega_{pj}   & Polstellenfrequenzen  & \omega_{zi}   & Nullstellenfrequenzen \\
    q_{pj}        & Polstellengüten       & q_{zi}        & Nullstellengüten
\end{ctabular}


\subsection{Pol- und Nullstellendiagramme}

\begin{minipage}[c]{0.35\columnwidth}
    \includegraphics[width=\columnwidth]{images/pol_nullstellen_diagramm.png}
\end{minipage}
\hfill
\begin{minipage}[c]{0.63\columnwidth}
    Werden die Pole und Nullstellen in der komplexen Zahlenebene dargestellt, so spricht man von einem Pol-/Nullstellen-Diagramm.

    In Matlab erzeugt der Befehl \texttt{pzmap} einen solchen Plot

    \begin{tabular}{ll}
        Pole    & Kreuze \\
        NS      & Kreise \\
    \end{tabular}
\end{minipage}


\subsection{Pole in der komplexen Zahlenebene}{214}

\example{Polynom 2. Ordnung mit komplex-konjugierten Polen}

\begin{minipage}[c]{0.45\columnwidth}
    \includegraphics[width=\columnwidth]{images/beispiel_pol_nullstellen_diagramm.png}
\end{minipage}
\hfill
\begin{minipage}[c]{0.48\columnwidth}
    $$(s - p_1) \cdot (s -p_2) = s^2 + 2 \sigma_p s + (\sigma_p^2 + \tilde{\omega}_p^2) $$
    $$ \boxed{ \omega_p = \sqrt{\sigma_p^2 + \tilde{\omega}_p^2}} $$
    $$ \boxed{ q_p = \frac{\omega_p}{2 \sigma_p} = \frac{1}{2 \cdot \cos(\alpha)}} $$
\end{minipage}

\begin{tabular}{ll}
    $\omega_p$  & Polfrequenz \textrightarrow\ Entspricht Abstand des Pols vom Ursprung \\
    $q_p$       & Polgüte \\
\end{tabular}

\vspace{0.2cm}
\textbf{\myul{Grenzfälle}} \\
\begin{tabular}{lll}
    $\sigma_p = \omega_p$   & Doppelpol auf neg. reeller Achse  & \textrightarrow\ $q_p = \frac{1}{2}$ \\
    $\sigma_p = 0$          & Polpar auf imaginärer Achse       & \textrightarrow\ $q_p = \infty$
\end{tabular}


\subsubsection{Reelle Pole}

\begin{minipage}[c]{0.48\columnwidth}
    $$ \boxed{ \omega_p = \sqrt{\sigma_{p1} \cdot \sigma_{p2} } } $$
\end{minipage}
\hfill
\begin{minipage}[c]{0.48\columnwidth}
    $$ \boxed{ q_p =  \frac{\sqrt{\sigma_{p1} \cdot \sigma_{p2}}}{\sigma_{p1} + \sigma_{p2}} \leq \frac{1}{2} } $$
\end{minipage}

\begin{itemize}
    \item[\textrightarrow] Für einzelne (reelle) Pole ist ist die Güte $q_p$ nicht definiert.
    \item[\textrightarrow] Die Polfrequenz $\omega_p$ entspricht dem Abstand zum Ursprung.
\end{itemize}

\textbf{\myul{Identische Werte}} \\ % stimmt das...?
\begin{tabular}{c c c}
    $\sigma_{p1} = \sigma_{p2}$ & & $q_p = \frac{1}{2}$
\end{tabular}


\subsubsection{Verallgemeinerung des Beispiels}
\begin{minipage}[c]{0.55\columnwidth}
    \includegraphics[width=\columnwidth]{images/pole_nullstellen_koeffizienten.png}
\end{minipage}
\hfill
\begin{minipage}[c]{0.42\columnwidth}
    \raggedright% needed to suppress underfull hbox warning
    \textbf{Hinweise}
    \begin{itemize}
        \item Pole sind als rote Kreuze dargestellt
        \item Für die NS (Nullstellenfrequenzen, Nullstellengüten) gelten die gleichen
            geometrischen Beziehungen wie für die Polstellen
    \end{itemize}
\end{minipage}




\subsection{Bestimmung Frequenzgang aus UTF}

Um den Frequenzgang zu erhalten, kann $s = j \omega$ eingesetzt werden.

$$ \boxed{ H(j \omega) = H(s) \Big|_{s = j \omega} = |H(j \omega)| \cdot e^{j \theta(\omega)} } $$

\begin{center}
    \begin{tabular}{ll}
        $H(s)$              & Übertragungsfunktion (UTF) \\
        $H(j \omega)$       & Frequenzgang 
    \end{tabular}\hspace{5mm}
    \begin{tabular}{ll}
        $|H(j \omega)|$     & Amplitudengang \\
        $\theta(\omega)$    & Phasengang
    \end{tabular}
\end{center}

Der Frequenzgang bzw. Amplitudengang und Phasengang werden folgendermassen dargestellt:

\begin{itemize}
    \item Nyquist-Diagramm \\
        $H(j \omega)$ wird in Polarkoordinaten mit $\omega$ als Parameter aufgezeichnet 
    \item \textbf{Bode-Diagramm} \\
        $\alpha_{\deci \bel}(\omega)$ und $\theta(\omega)$ werden je in Funktion von $\log_{10}(\omega)$ aufgezeichnet
\end{itemize}


\subsection{Bestimmung Frequenzgang aus Pol- / Nullstellendiagramm}

Durch einsetzen einer beliebigen Auswertungsfrequenz $j \omega_0$ in die Übertragungsfunktion $H(s)$ ergibt sich der
Frequenzgang $H(j \omega_0)$ als:

$$ H(j \omega_0) = K \cdot \frac{(j \omega_0 - z_1) (j \omega_0 - z_2) \cdots (j \omega_0 - z_m)}
                                {(j \omega_0 - p_1) (j \omega_0 - p_2) \cdots (j \omega_0 - p_n)}
                                = | H(j \omega_0) | \cdot e^{j \theta (\omega_0)} $$

Die einzelnen Faktoren in Zähler und Nenner können in Betrag und Phase aufgeteilt werden, beispielsweise folgendermassen:
$$ (j \omega_0 - p_1) = |j \omega_0 - z_1| \cdot e^{j \theta_{z1}} = A_{z1} \cdot e^{j \theta_{z1}} $$



Angewendet auf alle Faktoren kann der Frequenzgang $H(j \omega_0)$ in den \textcolor{orange}{Amplitudengang $|H(j \omega)|$} und den
\textcolor{green}{Phasengang $\theta(\omega)$} separiert werden:

$$ \boxed{ H(j \omega_0) = K \cdot \frac{\textcolor{orange}{A_{z1} \cdot A_{z2} \cdots A_{zm}} \cdot \textcolor{green}{e^{j(\theta_{z1} + \cdots + \theta_{zm})}}}
                                        {\textcolor{orange}{A_{p1} \cdot A_{p2} \cdots A_{pm}} \cdot \textcolor{green}{e^{j(\theta_{p1} + \cdots + \theta_{pm})}}} } $$

\vspace{0.2cm}
\begin{minipage}[t]{0.48\columnwidth}
    \begin{center}
        \textbf{Betrag}
    \end{center}
    \vspace{-0.2cm}
    $$ \boxed{ | H(j \omega_0) | = K \cdot \frac{\prod_{i=1}^{m} A_{zi}}{\prod_{j=1}^{n} A_{pj}} } $$
\end{minipage}
\hfill
\begin{minipage}[t]{0.48\columnwidth}
    \begin{center}
        \textbf{Phase}
    \end{center}
    \vspace{-0.2cm}
    $$ \boxed{ \theta(\omega_0) = \underbrace{\text{Phase von } K}_{\text{meistens } 0} + \sum_{i=1}^{m} \theta_{zi} - \sum_{j=1}^{m} \theta_{pj} } $$
\end{minipage}


\subsubsection{Zusammenhang mit Pol- / Nullstellendiagramm}

\begin{minipage}[c]{0.5\columnwidth}
    %\input{tikz/pole_nullstellen_auswertungsfrequenz.tex}
    Hier mit nur einer Nullstelle (keine Pole): 
    \includegraphics[width=\columnwidth]{images/frequenzgang_amplitudengang.png}
\end{minipage}
\hfill
\begin{minipage}[c]{0.48\columnwidth}
    Die Auswertungsfrequenz $j \omega_0$ ist variabel und 'wandert' auf der \textbf{imaginären Achse}.
    Für ein bestimmte Auswertungsfrequenz $j \omega_0$ können die Faktoren von $H(j \omega_0)$ als Abstand und Phase zu den
    Pol- bzw Nullstellen interpretiert werden.
    Somit kann grafisch aus dem Pol- Nullstellendiagramm ein Rückschluss auf den Amplitudengang gezogen werden.
\end{minipage}


\subsubsection{Rückschlüsse auf Amplitudengang}

\begin{itemize}
    \item Es werden vor allem die \textbf{Abstände} betrachtet 
    \item Pol- und Nullstellen können sich aufheben
    \item Nullstelle bei $\omega = 0$ \textrightarrow\ $|H(j \omega_0)| = \infty$ % stimmt das?
    \item Pol bei $\omega = 0$ \textrightarrow\ $|H(j \omega_0)| = 0$ % stimmt das?
    \item Weder Pol noch Nullstelle bei $\omega = 0$ \textrightarrow\ $|H(j \omega_0)|$ hat endlichen Wert
    \item $\omega = \infty$: Zählergrad $>$ Nennergrad \textrightarrow\ $|H(j \omega_0)| = \infty$
    \item $\omega = \infty$: Zählergrad $=$ Nennergrad \textrightarrow\ $|H(j \omega_0)|$ hat endlichen Wert
    \item $\omega = \infty$: Zählergrad $<$ Nennergrad \textrightarrow\ $|H(j \omega_0)| = 0$
    \item Weder Pol noch Nullstelle bei $\omega = 0$ \textrightarrow\ $\theta(j \omega_0) = 0$
    \item Pol bei $\omega = 0$ \textrightarrow\ $\theta(j \omega_0) = \frac{\pi}{2}$
    \item Nullstelle bei $\omega = 0$ \textrightarrow\ $\theta(j \omega_0) = -\frac{\pi}{2}$
    \item $\omega = \infty$: \textrightarrow\ $|H(j \omega_0)| = -\frac{\pi}{2}$
\end{itemize}





% maybe next lecture:
% \subsection{Nicht-minimalphasige Systeme}


% \subsection{Mininalphasige Systeme}

